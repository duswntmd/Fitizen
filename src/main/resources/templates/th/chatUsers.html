<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>

<div th:fragment="chatUsers">

    <!-- ì±„íŒ… ë²„íŠ¼ -->
    <div class="chat-button" onclick="toggleChat()">
        ğŸ’¬
        <span class="notification-badge" id="notificationBadge">0</span> <!-- ì•ˆì½ì€ ë©”ì‹œì§€ ìˆ«ì -->
    </div>
    <div class="chat-window" id="chatWindow">
        <div id="participantsList" class="participants-list" style="display: none;" >
            <div class="host-header" id="hostHeader"></div>
            <div class="participants"></div>
        </div>
        <div class="chat-header">
            <button class="expand-button" onclick="toggleExpandChat()">ğŸ”</button> <!-- New Expand Button -->
            <span class="current-challenge-title" style="display: none;"></span>
            <span class="participants-title" onclick="toggleParticipants()" style="display: none">ì°¸ì—¬ì ëª©ë¡</span>
            <button class="back-button" onclick="backButton()" style="display: none">ë’¤ë¡œê°€ê¸°</button>
            <span class="challenge-title" onclick="showChallenges()">ì°¸ì—¬ ì±Œë¦°ì§€
        <span class="challenge-badge" style="display:none;"></span> <!-- í•©ì‚°ëœ ì•Œë¦¼ ê°œìˆ˜ -->
      </span>
            <span class="trainer-title" onclick="myConsultations()">íŠ¸ë ˆì´ë„ˆ ìƒë‹´
      <span class="trainer-badge" style="display:none;"></span> <!-- í•©ì‚°ëœ ì•Œë¦¼ ê°œìˆ˜ -->
      </span>
            <button class="close-button" onclick="toggleChat()">ë‹«ê¸°</button>
        </div>
        <div class="chat-body" id="chatBody"></div>
    </div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript">


        /*ì•Œë¦¼ ë°°ì§€ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
        function updateNotificationBadge(count) {
          const badge = document.getElementById("notificationBadge");
          badge.textContent = count;
          badge.style.display = count > 0 ? "inline-block" : "none"; // ì•Œë¦¼ì´ 0ì´ë©´ ìˆ¨ê¹€
        }
        */


        /* ì„œë²„ì—ì„œ ì•Œë¦¼ ê°œìˆ˜ë¥¼ ê°€ì ¸ì™€ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
        function fetchUnreadMessageCount() {
          $.ajax({
            url: '/ws/unreadMessageCount',  // ì„œë²„ì—ì„œ ì•Œë¦¼ ê°œìˆ˜ë¥¼ ì œê³µí•˜ëŠ” ì—”ë“œí¬ì¸íŠ¸
            method: 'GET',
            success: function(count) {
              updateNotificationBadge(count); // ê°€ì ¸ì˜¨ ì•Œë¦¼ ê°œìˆ˜ë¡œ ë°°ì§€ ì—…ë°ì´íŠ¸
            },
            error: function(error) {
              console.error("ì•Œë¦¼ ìˆ˜ ì¡°íšŒ ì˜¤ë¥˜:", error);
            }
          });
        }
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì•Œë¦¼ ê°œìˆ˜ í™•ì¸
        fetchUnreadMessageCount();

        // ì£¼ê¸°ì ìœ¼ë¡œ ì•Œë¦¼ ê°œìˆ˜ë¥¼ í™•ì¸
        setInterval(fetchUnreadMessageCount, 5000); // 5ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸

    */


        function resetChatHeader() {
            const chatHeader = document.querySelector('.chat-header');

            // í—¤ë”ì˜ ë²„íŠ¼ê³¼ íƒ€ì´í‹€ì„ ì´ˆê¸° ìƒíƒœë¡œ ë¦¬ì…‹
            chatHeader.querySelector('.back-button').style.display = 'none';
            chatHeader.querySelector('.participants-title').style.display = 'none';
            chatHeader.querySelector('.current-challenge-title').style.display = 'none';
            chatHeader.querySelector('.challenge-title').style.display = 'block';
            chatHeader.querySelector('.trainer-title').style.display = 'block';
            const participantsList = document.getElementById('participantsList');
            participantsList.style.display = 'none';
        }

        var  userId ="";
        var chRoomId="";
        function toggleExpandChat() {
            const chatWindow = document.querySelector('.chat-window'); // í´ë˜ìŠ¤ ì„ íƒì ì‚¬ìš©
            chatWindow.classList.toggle('expanded'); // expanded í´ë˜ìŠ¤ í† ê¸€
        }

        function showParticipants(roomId) {
            const participantsList = document.getElementById('participantsList');
            const hostHeader = document.getElementById('hostHeader');
            const participantsContainer = document.querySelector('.participants');

            participantsList.style.display = 'block';

            // API í˜¸ì¶œí•˜ì—¬ ì°¸ì—¬ì ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
            fetch(`/ws/challUsers/${roomId}`)
                .then(response => response.json())
                .then(data => {
                    const participants = data.users; // DTOì—ì„œ ì°¸ì—¬ì ëª©ë¡ ê°€ì ¸ì˜¤ê¸°

                    // í˜¸ìŠ¤íŠ¸ í—¤ë”ì— ì§„í–‰ì ì •ë³´ ì¶”ê°€
                    hostHeader.textContent = `ì§„í–‰ì: ${data.creatorId}`; // ìƒì„±ì ID í‘œì‹œ

                    // ê¸°ì¡´ ì°¸ì—¬ì ëª©ë¡ ì´ˆê¸°í™”
                    participantsContainer.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš©ì„ ì§€ì›€

                    // ê° ì°¸ì—¬ìë¥¼ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
                    participants.forEach(userId => {
                        const item = document.createElement('div');
                        item.className = 'participant-item';
                        item.textContent = userId; // ì°¸ì—¬ì ì´ë¦„
                        participantsContainer.appendChild(item);
                    });
                })
                .catch(error => {
                    console.error('Error fetching participants:', error);
                });
        }
        function backButton() {
            resetChatHeader();
            // ì±Œë¦°ì§€ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
            showChallenges();
            g_webSocket.close();
            connectAlarmSocket(); // ì•Œë¦¼ ì†Œì¼“ ì¬ì—°ê²°
        }

        function toggleParticipants() {
            const participantsList = document.getElementById('participantsList');
            participantsList.style.display = participantsList.style.display === 'block' ? 'none' : 'block';

            if (participantsList.style.display === 'block') {
                showParticipants(chRoomId); // ì°¸ì—¬ì ëª©ë¡ì„ ë³´ì—¬ì£¼ê¸° ìœ„í•œ í•¨ìˆ˜ í˜¸ì¶œ
            }
        }
        const chatBody = document.getElementById('chatBody');
        function toggleChat() {

            const chatWindow = document.getElementById('chatWindow');
            chatWindow.style.display = chatWindow.style.display === 'block' ? 'none' : 'block';
            if (chatWindow.style.display === 'block') {
                showChallenges();
                connectAlarmSocket(); // ì•ŒëŒ ì†Œì¼“ ì—°ê²°
            }else{
                // alarmSocket.close();
                g_webSocket.close();
                resetChatHeader();
                location.reload();
            }

        }
        function connectAlarmSocket() {
            alarmSocket = new WebSocket("ws://" +project+ "/alarm");



            alarmSocket.onmessage = function(event) {
                const data = JSON.parse(event.data);

                // ìƒë‹´ë³„ ì•Œë¦¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸
                data.consultJsonArray.forEach(c => {
                    const { UnreadCount, ConsultId } = c;
                    const badge = document.getElementById(`unread-badge-${ConsultId}`);
                    if (badge) {
                        badge.textContent = UnreadCount;
                        badge.style.display = UnreadCount > 0 ? 'inline-block' : 'none';
                    }
                });

                // ì´ ì•Œë¦¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸
                const total = document.querySelector('.trainer-title .trainer-badge');
                const totalCount = data.totalUnreadConsultCount;
                if (totalCount > 0) {
                    total.textContent =totalCount;
                    total.style.display = 'inline-block';
                } else {
                    total.style.display = 'none';
                }


                // ì±Œë¦°ì§€ë³„ ë§ˆì§€ë§‰ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
                data.lastMessagesConsult.forEach(messageInfo => {
                    const { senderId, message, ConsultId, imge} = messageInfo;

                    // ê° ì±Œë¦°ì§€ IDì— í•´ë‹¹í•˜ëŠ” ë§ˆì§€ë§‰ ë©”ì‹œì§€ì™€ ë³´ë‚¸ ì‚¬ëŒ ì—…ë°ì´íŠ¸
                    // const senderElement = document.getElementById(`lastMessage-sender-${ChallengeId}`);
                    const messageElement = document.getElementById(`lastMessageConsult-content-${ConsultId}`);

                    /*
                    if (senderElement) {
                      senderElement.textContent = senderId;
                    }

                     */
                    if (messageElement) {
                        if(imge !=null)
                        {
                            messageElement.textContent = "ì‚¬ì§„ì„ ë³´ëƒˆìŠµë‹ˆë‹¤";
                            messageElement.style.fontStyle = 'italic';
                        }
                        else {
                            messageElement.textContent = message;
                            messageElement.style.fontStyle = 'italic';
                            // ë©”ì‹œì§€ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ ì¶”ê°€ (ì˜ˆ: ê¸°ìš¸ì„ê¼´)
                        }
                    }
                });





                // ì±Œë¦°ì§€ë³„ ì•Œë¦¼ ì—…ë°ì´íŠ¸
                data.challengeJsonArray.forEach(countInfo => {
                    const { UnreadCount, ChallengeId } = countInfo;
                    const badge = document.getElementById(`unread-badge-${ChallengeId}`);
                    if (badge) {
                        badge.textContent = UnreadCount;
                        badge.style.display = UnreadCount > 0 ? 'inline-block' : 'none';
                    }
                });

                // ì´ ì•Œë¦¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸
                const totalBadge = document.querySelector('.challenge-title .challenge-badge');
                const totalUnreadCount = data.totalUnreadChallengeCount;
                if (totalUnreadCount > 0) {
                    totalBadge.textContent = totalUnreadCount;
                    totalBadge.style.display = 'inline-block';
                } else {
                    totalBadge.style.display = 'none';
                }




                // ì±Œë¦°ì§€ë³„ ë§ˆì§€ë§‰ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
                data.lastMessages.forEach(messageInfo => {
                    const { senderId, message, ChallengeId, imge} = messageInfo;

                    // ê° ì±Œë¦°ì§€ IDì— í•´ë‹¹í•˜ëŠ” ë§ˆì§€ë§‰ ë©”ì‹œì§€ì™€ ë³´ë‚¸ ì‚¬ëŒ ì—…ë°ì´íŠ¸
                    // const senderElement = document.getElementById(`lastMessage-sender-${ChallengeId}`);
                    const messageElement = document.getElementById(`lastMessage-content-${ChallengeId}`);

                    /*
                    if (senderElement) {
                      senderElement.textContent = senderId;
                    }

                     */
                    if (messageElement) {
                        if(imge !=null)
                        {
                            messageElement.textContent = "ì‚¬ì§„ì„ ë³´ëƒˆìŠµë‹ˆë‹¤";
                            messageElement.style.fontStyle = 'italic';
                        }
                        else {
                            messageElement.textContent = message;
                            messageElement.style.fontStyle = 'italic';
                            // ë©”ì‹œì§€ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ ì¶”ê°€ (ì˜ˆ: ê¸°ìš¸ì„ê¼´)
                        }
                    }
                });

                // ì´ ìƒë‹´ ë° ì±Œë¦°ì§€ ì•Œë¦¼ ê°œìˆ˜ë¥¼ í•©ì‚°í•˜ì—¬ í‘œì‹œ
                const totalTotal = data.totalUnreadConsultCount + data.totalUnreadChallengeCount;
                const notificationBadge = document.getElementById("notificationBadge");

                if (notificationBadge) {
                    notificationBadge.textContent = totalTotal
                    notificationBadge.style.display = totalTotal > 0 ? "inline-block" : "none";
                }
            };

        }


        function myConsultations() {
            chatBody.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì‚­ì œ

            fetch('/ws/myConsultation')
                .then(response => response.json())
                .then(data => {
                    // ì²« ë²ˆì§¸ í•­ëª©ì—ì„œ ì—­í•  ì •ë³´ í™•ì¸
                    const isTrainer = data[0].isTrainer;
                    const myConsultList = data.slice(1); // ë‚˜ë¨¸ì§€ í•­ëª©ë“¤ì„ myConsult ë°ì´í„°ë¡œ ì‚¬ìš©

                    if (myConsultList.length === 0) { // ìƒë‹´ ëª©ë¡ì´ ì—†ì„ ê²½ìš°
                        chatBody.innerHTML = `<div class="empty-message">ì‹ ì²­ëœ ìƒë‹´ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
                        return;
                    }
                    myConsultList.forEach(consult => {
                        const item = document.createElement('div');

                        // ì—­í• ì— ë”°ë¥¸ í´ë˜ìŠ¤ ì ìš©
                        item.className = 'consult-list';

                        // íŠ¸ë ˆì´ë„ˆì¼ ê²½ìš° ìœ ì € ì´ë¦„ í‘œì‹œ, ìœ ì €ì¼ ê²½ìš° íŠ¸ë ˆì´ë„ˆ ì´ë¦„ í‘œì‹œ
                        const displayName = isTrainer ? consult.userName : consult.trainerName;

                        item.innerHTML = `
                   <div onclick="connectWebSocket('','${displayName}',${consult.consultId})" style="cursor: pointer;">
                       <span class="consult-name"><strong>${displayName}</strong></span>
                       <span class="consult-location">${consult.location || ''}</span>
                       <span class="last-message" id="lastMessageConsult-content-${consult.consultId}"></span>
                       <span class="unread-badge" id="unread-badge-${consult.consultId}" style="display:none;"></span>
                    </div>
                `;
                        chatBody.appendChild(item);
                    });
                })
                .catch(error => {
                    console.error('Error fetching consultations:', error);
                });

            connectAlarmSocket();

        }





        function showChallenges() {
            chatBody.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì‚­ì œ
            fetch('/ws/myChallenges')
                .then(response => response.json())  // ì‘ë‹µì„ JSONìœ¼ë¡œ ë³€í™˜
                .then(data => {
                    userId = data.userId;
                    const mychallList=data.challengeList;

                    if (mychallList.length === 0) { // ì±Œë¦°ì§€ ëª©ë¡ì´ ì—†ì„ ê²½ìš°
                        chatBody.innerHTML = `<div class="empty-message">ì°¸ì—¬ ì¤‘ì¸ ì±Œë¦°ì§€ê°€ ì—†ì–´ìš”.</div>`;
                        return;
                    }
                    // ì„œë²„ì—ì„œ ë°›ì•„ì˜¨ ì±Œë¦°ì§€ ëª©ë¡ì„ ê°ê° DOMì— ì¶”ê°€
                    mychallList.forEach(MyChallenges => {
                        const item = document.createElement('div');
                        item.className = 'myChall-list';
                        item.innerHTML = `
                                  <div onclick="connectWebSocket(${MyChallenges.challengeId},'${MyChallenges.title}','')" style="cursor: pointer;">
                                     <span class="challenge-title"><strong>${MyChallenges.title}</strong></span>
                                     <span class="challenge-participants">(${MyChallenges.members}/${MyChallenges.limitUser})</span>
                                     <span class="last-message" id="lastMessage-content-${MyChallenges.challengeId}"></span>
                                     <span class="unread-badge" id="unread-badge-${MyChallenges.challengeId}" style="display:none;"></span>
                                  </div>
                                     `;

                        chatBody.appendChild(item);
                    });
                    connectAlarmSocket();
                })
                .catch(error => {
                    console.error('Error fetching challenges:', error);
                });
        }

        var project ="fitizen.store";
        var host = "localhost";
        var g_webSocket = null;
        // ì›¹ì†Œì¼“ ì—°ê²° í•¨ìˆ˜
        function connectWebSocket(roomId,title ,consultId)
        {

            chRoomId=roomId;

            // ì±Œë¦°ì§€ ì„ íƒ ì‹œ í—¤ë” ì—…ë°ì´íŠ¸
            const chatHeader = document.querySelector('.chat-header');

            // ê¸°ì¡´ í—¤ë” ë‚´ìš© ìˆ¨ê¸°ê¸°
            chatHeader.querySelectorAll('.challenge-title,.trainer-title').forEach(el => {
                el.style.display = 'none';
            });
            chatHeader.querySelector('.back-button').style.display='block';
            chatHeader.querySelector('.participants-title').style.display='block';
            // ì±Œë¦°ì§€ ì œëª© ì—…ë°ì´íŠ¸
            const currentChallengeTitle = chatHeader.querySelector('.current-challenge-title');
            currentChallengeTitle.innerText = "\""+title+"\"";  // ì œëª© ì„¤ì •
            currentChallengeTitle.style.display = 'block';  // ì±Œë¦°ì§€ ì œëª© ë³´ì´ê¸°

            g_webSocket = new WebSocket("ws://" +project + "/chat?" + "roomId=" + roomId+"&consultId="+consultId);
            g_webSocket.onopen = function (message) {


                if (roomId !=='') {
                    showParticipants(roomId);
                }
                const participantsTitle = chatHeader.querySelector('.participants-title');
                if (consultId) {
                    // consultIdê°€ ì¡´ì¬í•˜ë©´ ì°¸ì—¬ì ëª©ë¡ í—¤ë” ìˆ¨ê¸°ê¸°
                    participantsTitle.style.display = 'none';
                }

                chatBody.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì‚­ì œ
                // ë©”ì‹œì§€ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆëŠ” HTML ì¶”ê°€
                const inputContainer = `
            <div id="chatBoxArea"></div>
            <div id="inputContainer">
                <input id="inputMsgBox" type="text" placeholder="ë©”ì„¸ì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">
                <input id="sendButton" type="button" value="ë³´ë‚´ê¸°" onclick="sendButton_onclick()">
                <label id="fileButton" for="imgInputBox">ì‚¬ì§„</label>
            </div>
            <input id="imgInputBox" type="file" accept="image/*">
        `;

                // chatBodyì— inputContainer ì¶”ê°€
                chatBody.innerHTML += inputContainer;

                if(roomId !=="") {
                    addLineToChatBox("ì±Œë¦°ì§€ ì°¸ì—¬ ì±„íŒ…ë°©ì…ë‹ˆë‹¤.", "", true);
                }else if(consultId !=="")
                {
                    addLineToChatBox("íŠ¸ë ˆì´ë„ˆ ìƒë‹´ë°©ì…ë‹ˆë‹¤.", "", true);
                }
                document.getElementById('inputMsgBox').addEventListener('keypress', inputMsgBox_onkeypress);

            };

            g_webSocket.onmessage = function(message) {
                try {
                    var data = JSON.parse(message.data); // JSON íŒŒì‹±

                    // ì•ˆ ì½ì€ ë©”ì‹œì§€ì¼ ê²½ìš°ì—ë§Œ ì½ìŒ ì²˜ë¦¬ ìš”ì²­
                    if (data.seen !=null &&!data.seen && data.sender !== userId) {
                        setTimeout(function() {
                            if(chRoomId !== '') {
                                sendReadReceiptToChallenge(data.messageId);
                            }else {
                                sendReadReceiptToConsult(data.messageId);
                            }
                        }, 500);  // 500ms ì§€ì—° í›„ ì½ìŒ ì²˜ë¦¬ ìš”ì²­
                    }


                    if (data.msg) {
                        console.log(data.msg)
                        addLineToChatBox(data.msg ,data.sender,false); // í…ìŠ¤íŠ¸ ë©”ì‹œì§€ ì¶”ê°€
                    }
                    if (data.img) {
                        displayImage(data.img, data.fileName , data.sender,false); // ì´ë¯¸ì§€ ì¶œë ¥
                    }
                }catch(e){
                    console.error("ë©”ì‹œì§€ íŒŒì‹± ì˜¤ë¥˜:", e);
                    addLineToChatBox(message.data,"",true); // JSONì´ ì•„ë‹ˆë©´ ê·¸ëŒ€ë¡œ ì¶œë ¥
                }
            };

            g_webSocket.onclose = function(message) {
                addLineToChatBox("ì¬ì ‘ì†í•´ì£¼ì„¸ìš”!..", "", true); // ì‹œìŠ¤í…œ ë©”ì‹œì§€ (isSystemMessage = true)
            };

            g_webSocket.onerror = function(message) {
                addLineToChatBox("Error!","",true);
            };
        }
        function addLineToChatBox(_line, sender,isSystemMessage = false) {
            if (_line == null) {
                _line = "";
            }
            var chatBoxArea = document.getElementById("chatBoxArea");
            var messageDiv = document.createElement("div");
            var senderIdDiv = document.createElement("div");

            messageDiv.textContent = _line; // ë©”ì‹œì§€ ì¶”ê°€
            senderIdDiv.textContent = sender; // ë°œì‹ ì ID ì¶”ê°€

            messageDiv.className = 'message';
            senderIdDiv.className = 'sender-id';

            // ë³´ë‚¸ ì‚¬ëŒì— ë”°ë¼ í´ë˜ìŠ¤ë¥¼ ë‹¤ë¥´ê²Œ ì„¤ì •
            // ì¡°ê±´: ë©”ì‹œì§€ ë‚´ìš©ì´ "ë³´ë‚¸ì‚¬ëŒë‹˜ì´ ì°¸ì—¬í•˜ì˜€ìŠµë‹ˆë‹¤." í˜•ì‹ì¼ ê²½ìš°
            const participationMessage = `${sender}ë‹˜ì´ ì°¸ì—¬í•˜ì˜€ìŠµë‹ˆë‹¤.`.trim().toLowerCase();
            const creatorMessage=`${sender}(ë‹¹ì‹ )ì€ ì£¼ìµœì ì…ë‹ˆë‹¤.!`.trim().toLowerCase();
            if (_line.trim().toLowerCase() === participationMessage ||_line.trim().toLowerCase() === creatorMessage||isSystemMessage) {
                // ì¤‘ì•™ì— ì •ë ¬
                messageDiv.classList.add('centered');
                senderIdDiv.style.display = 'none'; // ë°œì‹ ì ID ìˆ¨ê¹€ (ì´ë¯¸ ë©”ì‹œì§€ ë‚´ìš©ì— í¬í•¨ë˜ë¯€ë¡œ)

            } else if (sender === userId) {
                messageDiv.classList.add('sent');
                senderIdDiv.style.display = 'none'; // ìì‹ ì˜ ë©”ì‹œì§€ì—ëŠ” ë°œì‹ ì IDë¥¼ ìˆ¨ê¹€
            } else {
                messageDiv.classList.add('received');
            }

            // ë°œì‹ ì IDë¥¼ ë©”ì‹œì§€ ìœ„ì— ì¶”ê°€
            messageDiv.appendChild(senderIdDiv);

            chatBoxArea.appendChild(messageDiv); // divì— ì¶”ê°€
            chatBoxArea.scrollTop = chatBoxArea.scrollHeight;
        }

        function displayImage(base64Image, fileName, sender) {

            var chatBoxArea = document.getElementById("chatBoxArea");

            // ì´ë¯¸ì§€ì™€ ë²„íŠ¼ì„ í¬í•¨í•  ì»¨í…Œì´ë„ˆ div ìƒì„±
            var imageContainer = document.createElement("div");
            imageContainer.className = "image-container"; // ê¸°ë³¸ í´ë˜ìŠ¤ ì¶”ê°€

            var imgElement = document.createElement("img");
            imgElement.src = base64Image; // base64 ì´ë¯¸ì§€ë¥¼ img íƒœê·¸ì˜ srcë¡œ ì„¤ì •

            // ë°œì‹ ì IDë¥¼ ì¶”ê°€í•˜ëŠ” div ìƒì„±
            var senderIdDiv = document.createElement("div");
            senderIdDiv.textContent = sender;
            senderIdDiv.className = 'sender-id';


            // "ì‚¬ì§„ ì €ì¥" ë²„íŠ¼ ìƒì„±
            var saveButton = document.createElement("button");
            saveButton.textContent = "ì‚¬ì§„ ì €ì¥";
            saveButton.onclick = function() {
                downloadImage(base64Image, fileName);
            };


            // "ì¸ì¦ê²Œì‹œíŒì— ì˜¬ë¦¬ê¸°" ë²„íŠ¼ ìƒì„±

            var uploadButton = document.createElement("button");
            uploadButton.textContent = "ì¸ì¦ê²Œì‹œíŒì— ì˜¬ë¦¬ê¸°";
            uploadButton.onclick = function() {
                uploadToBoard(base64Image, fileName);
            };

            // ì´ë¯¸ì§€ì™€ ë²„íŠ¼ì„ ì»¨í…Œì´ë„ˆì— ì¶”ê°€
            imageContainer.appendChild(imgElement);




            // ë³´ë‚¸ ì‚¬ëŒì— ë”°ë¼ í´ë˜ìŠ¤ ì¶”ê°€
            if (sender === userId) {
                imageContainer.classList.add('sent'); // ì˜¤ë¥¸ìª½ ì •ë ¬
                senderIdDiv.style.display = 'none'; // ìì‹ ì˜ ì´ë¯¸ì§€ì—ëŠ” ë°œì‹ ì IDë¥¼ ìˆ¨ê¹€
                if(chRoomId) {
                    imageContainer.appendChild(uploadButton);
                }
            } else {
                imageContainer.classList.add('received'); // ì™¼ìª½ ì •ë ¬
                imageContainer.appendChild(saveButton);
            }

            // ë°œì‹ ì IDë¥¼ ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆ ìœ„ì— ì¶”ê°€
            imageContainer.appendChild(senderIdDiv);

            // ì»¨í…Œì´ë„ˆë¥¼ chatBoxAreaì— ì¶”ê°€
            chatBoxArea.appendChild(imageContainer);
            chatBoxArea.scrollTop = chatBoxArea.scrollHeight;
        }

        function downloadImage(base64Image, fileName) {
            var link = document.createElement("a");
            link.href = base64Image;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function uploadToBoard(base64Image, fileName) {

            var writeDate = getCurrentFormattedTime();
            var formData = new FormData();
            formData.append("base64Img", base64Image);
            formData.append("photo", fileName);
            formData.append("userId",userId);
            formData.append("writeDate",writeDate);
            formData.append("challengeId",chRoomId);


            if (confirm("ì¸ì¦ ê²Œì‹œë¬¼ë¡œ ì˜¬ë¦´ê±´ê°€ìš” ? \n" +
                "ì œëª©ì€ ì„ì‹œ ì œëª©ìœ¼ë¡œ ì˜¬ë¼ê°€ìš”! \n" +
                "ë‚˜ì¤‘ì— ìˆ˜ì •í•˜ì„¸ìš”! \n" +
                "-FITIZEN ê´€ë¦¬ì-"))
            {
                $.ajax({
                    url: '../proofShot/addChatProof',
                    method: 'post',
                    cache: false,
                    data: formData,
                    processData: false,  // FormData ê°ì²´ë¥¼ ì²˜ë¦¬í•  ë•ŒëŠ” falseë¡œ ì„¤ì •
                    contentType: false, // FormData ê°ì²´ë¥¼ ì²˜ë¦¬í•  ë•ŒëŠ” falseë¡œ ì„¤ì •
                    dataType: 'json',
                    success: function (res) {

                        if (res.success) {
                            alert("ì¸ì¦ ê²Œì‹œíŒì— ë“±ë¡ ë˜ì—ˆì–´ìš”!")
                            //location.reload();  // ìƒˆë¡œê³ ì¹¨
                        }

                    },
                    error: function (xhr, status, err) {
                        alert('ì—ëŸ¬:' + err);
                    }

                });
            }

        }

        function sendButton_onclick() {
            var inputMsgBox = document.getElementById("inputMsgBox");
            var imgInputBox = document.getElementById("imgInputBox");
            var currentTime = getCurrentFormattedTime();

            // ë©”ì‹œì§€ì™€ ì´ë¯¸ì§€ë¥¼ ì „ì†¡í•  ê°ì²´ë¥¼ ì¤€ë¹„
            var obj = {
                sender: userId,
                msg: inputMsgBox.value || null,
                img: null,
                sentAt: currentTime,
                fileName: imgInputBox.files.length > 0 ? imgInputBox.files[0].name : null
            };


            // ì´ë¯¸ì§€ íŒŒì¼ì´ ì„ íƒë˜ì—ˆìœ¼ë©´ base64ë¡œ ì¸ì½”ë”©í•˜ì—¬ ì¶”ê°€
            if (imgInputBox.files.length > 0) {
                var reader = new FileReader();
                reader.onload = function(event) {
                    obj.img = event.target.result;

                    // ë©”ì‹œì§€ë‚˜ ì´ë¯¸ì§€ ì¤‘ í•˜ë‚˜ê°€ ìˆìœ¼ë©´ ì „ì†¡
                    if (obj.msg || obj.img) {
                        g_webSocket.send(JSON.stringify(obj));
                    }
                };
                reader.readAsDataURL(imgInputBox.files[0]);
            } else {
                // ì´ë¯¸ì§€ê°€ ì—†ì„ ê²½ìš° ë©”ì‹œì§€ê°€ ìˆëŠ”ì§€ í™•ì¸ í›„ ì „ì†¡
                if (obj.msg) {
                    g_webSocket.send(JSON.stringify(obj));
                }
            }

            inputMsgBox.value = "";
            imgInputBox.value = "";
            inputMsgBox.focus();

            return true;
        }

        function inputMsgBox_onkeypress(event) {
            if (event == null) {
                return false;
            }
            var keyCode = event.keyCode || event.which;
            if (keyCode == 13) {
                sendButton_onclick(event);
            }
        }

        function getCurrentFormattedTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');

            return `${year}.${month}.${day} ${hours}:${minutes}`;
        }

        function sendReadReceiptToChallenge(messageId) {
            $.ajax({
                url: '/ws/readMessage',
                method: 'POST',
                data: { messageId: messageId },
                success: function(res) {
                    console.log("ì½ìŒ ì²˜ë¦¬ ì™„ë£Œ:", res);
                },
                error: function(err) {
                    console.error("ì½ìŒ ì²˜ë¦¬ ì˜¤ë¥˜:", err);
                }
            });
        }
        function sendReadReceiptToConsult(messageId) {
            $.ajax({
                url: '/ws/readMessageConsult',
                method: 'POST',
                data: { messageId: messageId },
                success: function(res) {
                    console.log("ì½ìŒ ì²˜ë¦¬ ì™„ë£Œ:", res);
                },
                error: function(err) {
                    console.error("ì½ìŒ ì²˜ë¦¬ ì˜¤ë¥˜:", err);
                }
            });
        }

        document.addEventListener("DOMContentLoaded", function() {
            connectAlarmSocket();
        });



    </script>
    <style>



        .participant-item {
            margin: 5px 3px; /* Space between participants */
            padding: 10px; /* Padding for better click area */
            background-color: #f0f0f0; /* Background color */
            border-radius: 3px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            text-align: center;
        }

        .participant-item:hover {
            background-color: #e0e0e0; /* Change color on hover */
        }
        .host-header {
            padding: 14px 15px; /* íŒ¨ë”© */
            background-color:#808080 ; /* ë°°ê²½ìƒ‰ */
            font-size: 16px; /* Adjust as needed */
            font-weight: bold; /* Bold text */
            margin-bottom: 10px; /* Spacing below the header */
            color: white; /* Text color */
        }
        .expand-button {
            background-color: transparent; /* ë°°ê²½ìƒ‰ íˆ¬ëª… */
            border: none; /* í…Œë‘ë¦¬ ì œê±° */
            color: white; /* ê¸€ì ìƒ‰ìƒ */
            cursor: pointer; /* í¬ì¸í„° ì»¤ì„œ */
            font-size: 16px; /* ê¸€ì í¬ê¸° */
            transition: color 0.3s; /* ìƒ‰ìƒ ì „í™˜ íš¨ê³¼ */
        }




        .chat-button {
            position: fixed;
            right: 50px; /* ì˜¤ë¥¸ìª½ì—ì„œì˜ ê°„ê²© */
            top: 50%; /* í™”ë©´ ì¤‘ê°„ ìœ„ì¹˜ */
            transform: translateY(-50%); /* ë²„íŠ¼ì„ ì¤‘ì•™ì— ìœ„ì¹˜ì‹œí‚´ */
            z-index: 1000; /* ë‹¤ë¥¸ ìš”ì†Œ ìœ„ì— í‘œì‹œë˜ë„ë¡ */
            cursor: pointer; /* í¬ì¸í„° ì»¤ì„œ */
            font-size: 40px; /* ì•„ì´ì½˜ í¬ê¸° */
            color: #007BFF; /* ì•„ì´ì½˜ ìƒ‰ìƒ */
            transition: transform 0.3s; /* í¬ê¸° ë³€í™˜ íš¨ê³¼ */
        }

        /* ì•Œë¦¼ ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .notification-badge {
            position: absolute;
            top: -5px; /* ë²„íŠ¼ ìœ„ìª½ ìœ„ì¹˜ ì¡°ì • */
            right: -10px; /* ë²„íŠ¼ ì˜¤ë¥¸ìª½ ìœ„ì¹˜ ì¡°ì • */
            background-color: red; /* ë°°ê²½ìƒ‰ */
            color: white; /* ê¸€ì ìƒ‰ìƒ */
            border-radius: 50%; /* ë‘¥ê¸€ê²Œ */
            padding: 5px 10px; /* íŒ¨ë”© */
            font-size: 12px; /* ê¸€ì í¬ê¸° */
            font-weight: bold; /* ê¸€ì ë‘ê»ê²Œ */
            display: inline-block; /* ì¸ë¼ì¸ ë¸”ë¡ */
        }



        /* ì±„íŒ… í—¤ë” ìŠ¤íƒ€ì¼ */
        .chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color:#808080 ; /* ë°°ê²½ìƒ‰ */
            color: white; /* ê¸€ì ìƒ‰ìƒ */
            padding: 10px 15px; /* íŒ¨ë”© */
            border-top-left-radius: 5px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
            border-top-right-radius: 5px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); /* ê·¸ë¦¼ì ì¶”ê°€ */
        }

        .challenge-title, .trainer-title,.consult-name ,.consult-location{
            font-size: 16px; /* ê¸€ì í¬ê¸° */
            font-weight: bold; /* ê¸€ì ë‘ê»ê²Œ */
            position: relative; /* ë¶€ëª¨ ìš”ì†Œì— ìƒëŒ€ ìœ„ì¹˜ë¥¼ ì„¤ì • */
        }
        .challenge-badge ,.trainer-badge {
            position: absolute;
            top: -20px; /* ë²„íŠ¼ ìœ„ìª½ ìœ„ì¹˜ */
            right: -20px; /* ì˜¤ë¥¸ìª½ì— ë°°ì¹˜ */
            background-color: red;
            color: white;
            border-radius: 50%;
            padding: 5px 10px;
            font-size: 12px;
            font-weight: bold;
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
        }


        .close-button {
            background-color: transparent; /* ë°°ê²½ìƒ‰ íˆ¬ëª… */
            border: none; /* í…Œë‘ë¦¬ ì œê±° */
            color: white; /* ê¸€ì ìƒ‰ìƒ */
            cursor: pointer; /* í¬ì¸í„° ì»¤ì„œ */
            font-size: 16px; /* ê¸€ì í¬ê¸° */
            transition: color 0.3s; /* ìƒ‰ìƒ ì „í™˜ íš¨ê³¼ */
        }
        .back-button {
            background-color: transparent; /* ë°°ê²½ìƒ‰ íˆ¬ëª… */
            border: none; /* í…Œë‘ë¦¬ ì œê±° */
            color: white; /* ê¸€ì ìƒ‰ìƒ */
            cursor: pointer; /* í¬ì¸í„° ì»¤ì„œ */
            font-size: 16px; /* ê¸€ì í¬ê¸° */
            transition: color 0.3s; /* ìƒ‰ìƒ ì „í™˜ íš¨ê³¼ */
        }


        .close-button:hover {
            color: #FF6B6B; /* hover ì‹œ ìƒ‰ìƒ ë³€ê²½ */
        }



        .participants-list {
            width: 250px; /* ì°¸ì—¬ì ëª©ë¡ ë„ˆë¹„ */
            background-color: white; /* ë°°ê²½ìƒ‰ */
            border: 1px solid #ccc;
            border-radius: 5px;
            overflow-y: auto; /* ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
            height: 490px; /* ë†’ì´ ì„¤ì • */
            position: absolute; /* ì ˆëŒ€ ìœ„ì¹˜ ì„¤ì • */
            left: -270px; /* ì±— ìœˆë„ìš°ì˜ ì™¼ìª½ ë°”ê¹¥ìª½ì— ìœ„ì¹˜í•˜ë„ë¡ ì„¤ì • */
            top: 0; /* ìœ„ìª½ ì •ë ¬ */
        }

        /* ì±„íŒ…ì°½ ìŠ¤íƒ€ì¼ */
        .chat-window {
            position: fixed;
            right: 20px;
            bottom: 20px;
            width: 500px; /* ì±„íŒ…ì°½ ë„ˆë¹„ */
            height: 600px; /* ì±„íŒ…ì°½ ê³ ì • ë†’ì´ */
            border: 1px solid #ccc;
            border-radius: 5px;
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1001; /* ë²„íŠ¼ë³´ë‹¤ ìœ„ì— í‘œì‹œë˜ë„ë¡ */
        }
        .chat-window.expanded {
            width: 1400px; /* Expanded width */
            height: 900px; /* Expanded height */
        }

        /* ì±„íŒ… ë³¸ë¬¸ ìŠ¤íƒ€ì¼ */
        .chat-body {
            padding: 20px;
            height: calc(100% - 80px); /* í—¤ë”ì™€ í‘¸í„°ë¥¼ ì œì™¸í•œ ë†’ì´ ê³„ì‚° */
        }

        /* ëª©ë¡ ìŠ¤íƒ€ì¼ */
        .myChall-list,.consult-list {
            margin: 5px 0;
            padding: 20px;
            border-radius: 3px;
            background-color:#e0e0e0; /* ë°°ê²½ìƒ‰ */
            cursor: pointer;
            position: relative;


        }


        .myChall-list > div {
            display: flex;
            align-items: center;
            gap: 20px; /* ìš”ì†Œë“¤ ê°„ ê°„ê²© */
        }

        .unread-badge ,.unread-badgeC {
            background-color: red;
            color: white;
            border-radius: 50%;
            padding: 5px 10px;
            font-size: 12px;
            font-weight: bold;
            position: absolute;
            right: 10px;
            display: none;
        }
        .myChall-list:hover {
            background-color: #d4d4d4; /* hover ì‹œ ìƒ‰ìƒ ë³€ê²½ */
        }






        #chatBoxArea {
            width: 100%;
            height: calc(100% - 80px); /* ì±„íŒ… ë°•ìŠ¤ì˜ ë†’ì´ë¥¼ ì „ì²´ ë†’ì´ì—ì„œ ì¸í’‹ ì»¨í…Œì´ë„ˆì˜ ë†’ì´ë¥¼ ë¹¼ì„œ ì¡°ì • */
            border: none;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            background-color: #e8e8e8; /* ë°°ê²½ìƒ‰ í†µì¼ */
            font-size: 16px; /* ê¸€ì”¨ í¬ê¸° ì¦ê°€ */
            display: flex;
            flex-direction: column; /* ì„¸ë¡œ ì •ë ¬ */
            align-items: stretch;
        }

        #inputContainer {
            display: flex;
            align-items: center;
            padding: 15px;
            height: 80px; /* ì¸í’‹ ì»¨í…Œì´ë„ˆ ë†’ì´ ì¡°ì • */
            gap: 10px;
            justify-content: center; /* ë²„íŠ¼ì„ ê°€ìš´ë° ì •ë ¬ */
        }

        #inputMsgBox {
            flex: 1;
            padding: 11px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px; /* ê¸€ì”¨ í¬ê¸° ì¦ê°€ */
            height: 21px; /* ë†’ì´ ì¦ê°€ */

        }

        #sendButton, #disconnectButton, #fileButton {
            background-color: #808080; /* ê²€ì •ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px; /* ê¸€ì”¨ í¬ê¸° ì¦ê°€ */
            margin-left: 10px; /* ë²„íŠ¼ ì‚¬ì´ ê°„ê²© ì¶”ê°€ */
        }

        #disconnectButton {
            background-color: #000; /* ê²€ì •ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
        }



        #sendButton:hover, #disconnectButton:hover, #fileButton:hover {
            opacity: 0.8;
        }

        #imgInputBox {
            display: none; /* ìˆ¨ê²¨ì§„ íŒŒì¼ ì…ë ¥ í•„ë“œ */
        }

        .message {
            padding: 10px;
            margin: 5px;
            border-radius: 10px;
            max-width: 80%;
            word-break: break-word;
            display: inline-block; /* ì»¨í…Œì´ë„ˆë¥¼ ì¸ë¼ì¸ ë¸”ë¡ìœ¼ë¡œ ì„¤ì • */
        }


        .message.sent {
            align-self: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
            background-color: #e1ffc7; /* ë‹¤ë¥¸ ë°°ê²½ìƒ‰ìœ¼ë¡œ í‘œì‹œ */
            text-align: right; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
            position: relative; /* ë°œì‹ ì ì•„ì´ë””ë¥¼ ìœ„ì¹˜ì‹œí‚¤ê¸° ìœ„í•´ ìƒëŒ€ ìœ„ì¹˜ ì„¤ì • */
        }

        .message.received {
            align-self: flex-start; /* ì™¼ìª½ ì •ë ¬ */
            background-color: #f1f0f0; /* ê¸°ë³¸ ë°°ê²½ìƒ‰ */
            text-align: left; /* ì™¼ìª½ ì •ë ¬ */
            position: relative; /* ë°œì‹ ì ì•„ì´ë””ë¥¼ ìœ„ì¹˜ì‹œí‚¤ê¸° ìœ„í•´ ìƒëŒ€ ìœ„ì¹˜ ì„¤ì • */
        }

        .image-container {
            margin-top: 10px;
            max-width: 80%;
            word-break: break-word;
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* ê¸°ë³¸ ì™¼ìª½ ì •ë ¬ */
        }



        .sender-id {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        .image-container.received {
            align-items: flex-start; /* ê¸°ë³¸ ì™¼ìª½ ì •ë ¬ */
            text-align: left; /* ì™¼ìª½ ì •ë ¬ */
        }

        /* ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ ìˆ˜ì • */
        .image-container img {
            max-width: 80%; /* ì»¨í…Œì´ë„ˆì˜ ë„ˆë¹„ì— ë§ì¶°ì„œ í¬ê¸° ì¡°ì ˆ */
            max-height: 80%; /* ìµœëŒ€ ë†’ì´ ì„¤ì • */
            height: auto; /* ë¹„ìœ¨ ìœ ì§€ */
            border-radius: 8px;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .image-container button {
            margin: 2px 5px; /* ìƒí•˜ ì—¬ë°±ì„ ì¤„ì´ê³ , ì¢Œìš° ì—¬ë°± ìœ ì§€ */
        }

        .image-container.sent {
            align-self: flex-end;
            align-items: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
            text-align: right; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
            margin-right: 0; /* ì˜¤ë¥¸ìª½ ì—¬ë°± ì œê±° */
            padding-right: 0; /* ì˜¤ë¥¸ìª½ íŒ¨ë”© ì œê±° */


        }


        .current-challenge-title {
            font-size: 20px; /* ê¸€ì í¬ê¸° */
            font-weight: bold; /* ê¸€ì ë‘ê»˜ */
            color: white; /* ê¸€ì ìƒ‰ìƒ */
            padding: 1px; /* ì•ˆìª½ ì—¬ë°± */
            text-align: center; /* ê°€ìš´ë° ì •ë ¬ */
        }

        .participants-title,.trainer-title,.challenge-title {
            width: 100px; /* ê³ ì • ê°€ë¡œ ë„ˆë¹„ */
            cursor: pointer; /* ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ì†ê°€ë½ ëª¨ì–‘ìœ¼ë¡œ ë³€ê²½ */
            text-overflow: ellipsis; /* ì œëª©ì´ ê¸¸ë©´ ë§ì¤„ì„ í‘œì‹œ */

        }

        .message.centered {
            align-self: center; /* ì¤‘ì•™ì— ë°°ì¹˜ */
            background-color: transparent; /* ë°°ê²½ìƒ‰ ì œê±° */
            color: #555; /* ì‚´ì§ ì—°í•œ íšŒìƒ‰ ê¸€ì”¨ */
            text-align: center; /* í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬ */
            max-width: 100%; /* ë©”ì‹œì§€ ë°•ìŠ¤ì˜ ë„ˆë¹„ë¥¼ ë„“ê²Œ */
            border-bottom: 1px solid #ccc; /* ì—°í•œ íšŒìƒ‰ ì¤„ ì¶”ê°€ */
            padding: 10px 0; /* ìƒí•˜ ì—¬ë°±ì„ ì£¼ì–´ ê³µê°„ í™•ë³´ */
        }

        /* ì¸ì› ì •ë³´ ìŠ¤íƒ€ì¼ */
        .challenge-participants ,.consult-payment-status{
            color: #888;
            width: 80px; /* ê³ ì • ê°€ë¡œ ë„ˆë¹„ */
            font-size: 14px;
        }

        /* ë§ˆì§€ë§‰ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .last-message {

            color: #0056b3;
            font-size: 16px; /* ê¸€ì”¨ í¬ê¸° */
            margin-left: 20px; /* ì¸ì› ì •ë³´ì™€ ë©”ì‹œì§€ ì‚¬ì´ ê°„ê²© ì¡°ì • */
            width: 130px; /* ê³ ì • ê°€ë¡œ ë„ˆë¹„ */
            white-space: nowrap; /* í•œ ì¤„ì— í‘œì‹œ */
            overflow: hidden; /* ë‚´ìš©ì´ ë„˜ì¹  ê²½ìš° ìˆ¨ê¹€ */
            text-overflow: ellipsis; /* ë©”ì‹œì§€ê°€ ê¸¸ë©´ ë§ì¤„ì„ í‘œì‹œ */
            transition: opacity 0.5s ease-in-out, transform 0.3s ease; /* ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ */
            opacity: 1;

        }

        .empty-message {
            display: flex;
            justify-content: center;   /* ê°€ë¡œ ê°€ìš´ë° ì •ë ¬ */
            align-items: center;       /* ì„¸ë¡œ ê°€ìš´ë° ì •ë ¬ */
            height: 50%;              /* ë¶€ëª¨ ìš”ì†Œ ë†’ì´ì— ë§ì¶”ê¸° */
            color: red;                /* ê¸€ì”¨ ìƒ‰ìƒ ë¹¨ê°„ìƒ‰ */
            font-size: 18px;           /* ê¸€ì”¨ í¬ê¸° */
            font-weight: bold;         /* ê¸€ì”¨ ë‘ê»˜ */
        }



    </style>
</div>
</body>
</html>
