<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="en">
<head>
  <meta charset="UTF-8">
</head>
<body>

<div th:fragment="chatT">

  <!-- ì±„íŒ… ë²„íŠ¼ -->
  <div class="chat-button" onclick="toggleChat()">
    ğŸ’¬
    <span class="notification-badge" id="notificationBadge">3</span> <!-- ì•ˆì½ì€ ë©”ì‹œì§€ ìˆ«ì -->
  </div>
  <div class="chat-window" id="chatWindow">
    <div id="participantsList" class="participants-list" style="display: none;" >
      <div class="host-header" id="hostHeader"></div>
      <div class="participants"></div>
    </div>
    <div class="chat-header">
      <button class="expand-button" onclick="toggleExpandChat()">ğŸ”</button> <!-- New Expand Button -->
      <span class="current-challenge-title" style="display: none;"></span>
      <span class="participants-title" onclick="toggleParticipants()" style="display: none">ì°¸ì—¬ì ëª©ë¡</span>
      <button class="back-button" onclick="backButton()" style="display: none">ë’¤ë¡œê°€ê¸°</button>
      <span class="challenge-title" onclick="showChallenges()">ì°¸ì—¬ ì±Œë¦°ì§€</span>
      <span class="trainer-title" onclick="showTrainers()">íŠ¸ë ˆì´ë„ˆ</span>
      <button class="close-button" onclick="toggleChat()">ë‹«ê¸°</button>
    </div>
    <div class="chat-body" id="chatBody"></div>
    </div>


  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script type="text/javascript">

    function resetChatHeader() {
      const chatHeader = document.querySelector('.chat-header');

      // í—¤ë”ì˜ ë²„íŠ¼ê³¼ íƒ€ì´í‹€ì„ ì´ˆê¸° ìƒíƒœë¡œ ë¦¬ì…‹
      chatHeader.querySelector('.back-button').style.display = 'none';
      chatHeader.querySelector('.participants-title').style.display = 'none';
      chatHeader.querySelector('.current-challenge-title').style.display = 'none';
      chatHeader.querySelector('.challenge-title').style.display = 'block';
      chatHeader.querySelector('.trainer-title').style.display = 'block';
      const participantsList = document.getElementById('participantsList');
      participantsList.style.display = 'none';
    }

    var  userId ="";
    var chRoomId="";
    function toggleExpandChat() {
      const chatWindow = document.querySelector('.chat-window'); // í´ë˜ìŠ¤ ì„ íƒì ì‚¬ìš©
      chatWindow.classList.toggle('expanded'); // expanded í´ë˜ìŠ¤ í† ê¸€
    }

    function showParticipants(roomId) {
      const participantsList = document.getElementById('participantsList');
      const hostHeader = document.getElementById('hostHeader');
      const participantsContainer = document.querySelector('.participants');

      participantsList.style.display = 'block';

      // API í˜¸ì¶œí•˜ì—¬ ì°¸ì—¬ì ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
      fetch(`/ws/challUsers/${roomId}`)
              .then(response => response.json())
              .then(data => {
                const participants = data.users; // DTOì—ì„œ ì°¸ì—¬ì ëª©ë¡ ê°€ì ¸ì˜¤ê¸°

                // í˜¸ìŠ¤íŠ¸ í—¤ë”ì— ì§„í–‰ì ì •ë³´ ì¶”ê°€
                hostHeader.textContent = `ì§„í–‰ì: ${data.creatorId}`; // ìƒì„±ì ID í‘œì‹œ

                // ê¸°ì¡´ ì°¸ì—¬ì ëª©ë¡ ì´ˆê¸°í™”
                participantsContainer.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš©ì„ ì§€ì›€

                // ê° ì°¸ì—¬ìë¥¼ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
                participants.forEach(userId => {
                  const item = document.createElement('div');
                  item.className = 'participant-item';
                  item.textContent = userId; // ì°¸ì—¬ì ì´ë¦„
                  participantsContainer.appendChild(item);
                });
              })
              .catch(error => {
                console.error('Error fetching participants:', error);
              });
    }
    function backButton() {
      resetChatHeader();
      // ì±Œë¦°ì§€ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
      showChallenges();
    }

    function toggleParticipants() {
      const participantsList = document.getElementById('participantsList');
      participantsList.style.display = participantsList.style.display === 'block' ? 'none' : 'block';

      if (participantsList.style.display === 'block') {
        showParticipants(chRoomId); // ì°¸ì—¬ì ëª©ë¡ì„ ë³´ì—¬ì£¼ê¸° ìœ„í•œ í•¨ìˆ˜ í˜¸ì¶œ
      }
    }
    const chatBody = document.getElementById('chatBody');
    function toggleChat() {
      const chatWindow = document.getElementById('chatWindow');
      chatWindow.style.display = chatWindow.style.display === 'block' ? 'none' : 'block';
      if (chatWindow.style.display === 'block') {
        showChallenges();
      }else{
        // í—¤ë” ì´ˆê¸°í™”
        resetChatHeader();
      }

    }


    function showChallenges() {
        chatBody.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì‚­ì œ
        fetch('/ws/myChallenges')
                .then(response => response.json())  // ì‘ë‹µì„ JSONìœ¼ë¡œ ë³€í™˜
                .then(data => {
                  userId = data.userId;
                  const mychallList=data.challengeList;
                  // ì„œë²„ì—ì„œ ë°›ì•„ì˜¨ ì±Œë¦°ì§€ ëª©ë¡ì„ ê°ê° DOMì— ì¶”ê°€
                  mychallList.forEach(MyChallenges => {
                    const item = document.createElement('div');
                    item.className = 'myChall-list';
                    item.innerHTML = `
                                   <div onclick="connectWebSocket(${MyChallenges.challengeId},'${MyChallenges.title}')" style="cursor: pointer;">
                                     <strong>${MyChallenges.title}</strong>
                                     (${MyChallenges.members}/${MyChallenges.limitUser})
                                   </div>
                                     `;

                    chatBody.appendChild(item);
                  });
                })
                .catch(error => {
                  console.error('Error fetching challenges:', error);
                });
      }

    var host = "localhost";
    var g_webSocket = null;
    // ì›¹ì†Œì¼“ ì—°ê²° í•¨ìˆ˜
    function connectWebSocket(roomId,title)
    {

      chRoomId=roomId;

      // ì±Œë¦°ì§€ ì„ íƒ ì‹œ í—¤ë” ì—…ë°ì´íŠ¸
      const chatHeader = document.querySelector('.chat-header');

      // ê¸°ì¡´ í—¤ë” ë‚´ìš© ìˆ¨ê¸°ê¸°
      chatHeader.querySelectorAll('.challenge-title,.trainer-title').forEach(el => {
        el.style.display = 'none';
      });
      chatHeader.querySelector('.back-button').style.display='block';
      chatHeader.querySelector('.participants-title').style.display='block';
      // ì±Œë¦°ì§€ ì œëª© ì—…ë°ì´íŠ¸
      const currentChallengeTitle = chatHeader.querySelector('.current-challenge-title');
      currentChallengeTitle.innerText = "\""+title+"\"";  // ì œëª© ì„¤ì •
      currentChallengeTitle.style.display = 'block';  // ì±Œë¦°ì§€ ì œëª© ë³´ì´ê¸°

      g_webSocket = new WebSocket("ws://" + host + "/chat?" + "roomId=" + roomId);
      g_webSocket.onopen = function (message) {

        showParticipants(roomId);

        chatBody.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì‚­ì œ
        // ë©”ì‹œì§€ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆëŠ” HTML ì¶”ê°€
        const inputContainer = `
            <div id="chatBoxArea"></div>
            <div id="inputContainer">
                <input id="inputMsgBox" type="text" placeholder="Type a message...">
                <input id="sendButton" type="button" value="ë³´ë‚´ê¸°" onclick="sendButton_onclick()">
                <label id="fileButton" for="imgInputBox">ì‚¬ì§„</label>
            </div>
            <input id="imgInputBox" type="file" accept="image/*">
        `;

        // chatBodyì— inputContainer ì¶”ê°€
        chatBody.innerHTML += inputContainer;

        addLineToChatBox("ì±Œë¦°ì§€ ì°¸ì—¬ ì±„íŒ…ë°©ì…ë‹ˆë‹¤.");
        document.getElementById('inputMsgBox').addEventListener('keypress', inputMsgBox_onkeypress);

      };

      g_webSocket.onmessage = function(message) {
        try {
          var data = JSON.parse(message.data); // JSON íŒŒì‹±


          /*
          // ì•ˆ ì½ì€ ë©”ì‹œì§€ì¼ ê²½ìš°ì—ë§Œ ì½ìŒ ì²˜ë¦¬ ìš”ì²­
          if (!data.seen) {
            sendReadReceiptToServer(data.messageId);
          }


           // ì½ìŒ ì²˜ë¦¬ ìš”ì²­ í•¨ìˆ˜
          function sendReadReceiptToServer(messageId) {
            // ì„œë²„ì— ì½ìŒ ì²˜ë¦¬ ìš”ì²­
            $.ajax({
              url: '/ws/readMessage',
              method: 'POST',
              data: { messageId: messageId },
              success: function(res) {
                console.log("ì½ìŒ ì²˜ë¦¬ ì™„ë£Œ:", res);
              },
              error: function(err) {
                console.error("ì½ìŒ ì²˜ë¦¬ ì˜¤ë¥˜:", err);
              }
            });
           */



          if (data.msg) {
            addLineToChatBox(data.msg ,data.sender); // í…ìŠ¤íŠ¸ ë©”ì‹œì§€ ì¶”ê°€
          }
          if (data.img) {
            displayImage(data.img, data.fileName , data.sender); // ì´ë¯¸ì§€ ì¶œë ¥
          }
        }catch(e){
          console.error("ë©”ì‹œì§€ íŒŒì‹± ì˜¤ë¥˜:", e);
          addLineToChatBox(message.data); // JSONì´ ì•„ë‹ˆë©´ ê·¸ëŒ€ë¡œ ì¶œë ¥
        }
      };

      g_webSocket.onclose = function(message) {
        addLineToChatBox("ì±„íŒ… ì ‘ì† ì‹¤íŒ¨...ê°œë°œì ìˆ˜ì •ì¤‘..");
      };

      g_webSocket.onerror = function(message) {
        addLineToChatBox("Error!");
      };
    }
    function addLineToChatBox(_line, sender) {
      if (_line == null) {
        _line = "";
      }
      var chatBoxArea = document.getElementById("chatBoxArea");
      var messageDiv = document.createElement("div");
      var senderIdDiv = document.createElement("div");

      messageDiv.textContent = _line; // ë©”ì‹œì§€ ì¶”ê°€
      senderIdDiv.textContent = sender; // ë°œì‹ ì ID ì¶”ê°€

      messageDiv.className = 'message';
      senderIdDiv.className = 'sender-id';

      // ë³´ë‚¸ ì‚¬ëŒì— ë”°ë¼ í´ë˜ìŠ¤ë¥¼ ë‹¤ë¥´ê²Œ ì„¤ì •
      if (sender === userId) {
        messageDiv.classList.add('sent');
        senderIdDiv.style.display = 'none'; // ìì‹ ì˜ ë©”ì‹œì§€ì—ëŠ” ë°œì‹ ì IDë¥¼ ìˆ¨ê¹€
      } else {
        messageDiv.classList.add('received');
      }

      // ë°œì‹ ì IDë¥¼ ë©”ì‹œì§€ ìœ„ì— ì¶”ê°€
      messageDiv.appendChild(senderIdDiv);

      chatBoxArea.appendChild(messageDiv); // divì— ì¶”ê°€
      chatBoxArea.scrollTop = chatBoxArea.scrollHeight;
    }

    function displayImage(base64Image, fileName, sender) {

      var chatBoxArea = document.getElementById("chatBoxArea");

      // ì´ë¯¸ì§€ì™€ ë²„íŠ¼ì„ í¬í•¨í•  ì»¨í…Œì´ë„ˆ div ìƒì„±
      var imageContainer = document.createElement("div");
      imageContainer.className = "image-container"; // ê¸°ë³¸ í´ë˜ìŠ¤ ì¶”ê°€

      var imgElement = document.createElement("img");
      imgElement.src = base64Image; // base64 ì´ë¯¸ì§€ë¥¼ img íƒœê·¸ì˜ srcë¡œ ì„¤ì •

      // ë°œì‹ ì IDë¥¼ ì¶”ê°€í•˜ëŠ” div ìƒì„±
      var senderIdDiv = document.createElement("div");
      senderIdDiv.textContent = sender;
      senderIdDiv.className = 'sender-id';


      // "ì‚¬ì§„ ì €ì¥" ë²„íŠ¼ ìƒì„±
      var saveButton = document.createElement("button");
      saveButton.textContent = "ì‚¬ì§„ ì €ì¥";
      saveButton.onclick = function() {
        downloadImage(base64Image, fileName);
      };

      // "ë”°ë´‰" ë²„íŠ¼ ìƒì„±
      var likeButton = document.createElement("button");
      likeButton.textContent = "ğŸ‘";
      likeButton.onclick = function() {
        alert("ë”°ë´‰ ë²„íŠ¼ í´ë¦­ë¨!"); // ì›í•˜ëŠ” í–‰ë™ì„ ì •ì˜
      };

      // "ì¸ì¦ê²Œì‹œíŒì— ì˜¬ë¦¬ê¸°" ë²„íŠ¼ ìƒì„±

      var uploadButton = document.createElement("button");
      uploadButton.textContent = "ì¸ì¦ê²Œì‹œíŒì— ì˜¬ë¦¬ê¸°";
      uploadButton.onclick = function() {
        uploadToBoard(base64Image, fileName);
      };

      // ì´ë¯¸ì§€ì™€ ë²„íŠ¼ì„ ì»¨í…Œì´ë„ˆì— ì¶”ê°€
      imageContainer.appendChild(imgElement);




      // ë³´ë‚¸ ì‚¬ëŒì— ë”°ë¼ í´ë˜ìŠ¤ ì¶”ê°€
      if (sender === userId) {
        imageContainer.classList.add('sent'); // ì˜¤ë¥¸ìª½ ì •ë ¬
        senderIdDiv.style.display = 'none'; // ìì‹ ì˜ ì´ë¯¸ì§€ì—ëŠ” ë°œì‹ ì IDë¥¼ ìˆ¨ê¹€
        imageContainer.appendChild(uploadButton);
      } else {
        imageContainer.classList.add('received'); // ì™¼ìª½ ì •ë ¬
        imageContainer.appendChild(likeButton);
        imageContainer.appendChild(saveButton);
      }

      // ë°œì‹ ì IDë¥¼ ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆ ìœ„ì— ì¶”ê°€
      imageContainer.appendChild(senderIdDiv);

      // ì»¨í…Œì´ë„ˆë¥¼ chatBoxAreaì— ì¶”ê°€
      chatBoxArea.appendChild(imageContainer);
      chatBoxArea.scrollTop = chatBoxArea.scrollHeight;
    }

    function downloadImage(base64Image, fileName) {
      var link = document.createElement("a");
      link.href = base64Image;
      link.download = fileName;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    function uploadToBoard(base64Image, fileName) {

      var writeDate = getCurrentFormattedTime();
      var formData = new FormData();
      formData.append("base64Img", base64Image);
      formData.append("photo", fileName);
      formData.append("userId",userId);
      formData.append("writeDate",writeDate);
      formData.append("challengeId",chRoomId);


      if (confirm("ì¸ì¦ ê²Œì‹œë¬¼ë¡œ ì˜¬ë¦´ê±´ê°€ìš” ? \n" +
              "ì œëª©ì€ ì„ì‹œ ì œëª©ìœ¼ë¡œ ì˜¬ë¼ê°€ìš”! \n" +
              "ë‚˜ì¤‘ì— ìˆ˜ì •í•˜ì„¸ìš”! \n" +
              "-FITIZEN ê´€ë¦¬ì-"))
      {
        $.ajax({
          url: '../proofShot/addChatProof',
          method: 'post',
          cache: false,
          data: formData,
          processData: false,  // FormData ê°ì²´ë¥¼ ì²˜ë¦¬í•  ë•ŒëŠ” falseë¡œ ì„¤ì •
          contentType: false, // FormData ê°ì²´ë¥¼ ì²˜ë¦¬í•  ë•ŒëŠ” falseë¡œ ì„¤ì •
          dataType: 'json',
          success: function (res) {

            if (res.success) {
              alert("ì¸ì¦ ê²Œì‹œíŒì— ë“±ë¡ ë˜ì—ˆì–´ìš”!")
              //location.reload();  // ìƒˆë¡œê³ ì¹¨
            }

          },
          error: function (xhr, status, err) {
            alert('ì—ëŸ¬:' + err);
          }

        });
      }

    }

    function sendButton_onclick() {
      var inputMsgBox = document.getElementById("inputMsgBox");
      var imgInputBox = document.getElementById("imgInputBox");
      var currentTime = getCurrentFormattedTime();

      // ë©”ì‹œì§€ì™€ ì´ë¯¸ì§€ë¥¼ ì „ì†¡í•  ê°ì²´ë¥¼ ì¤€ë¹„
      var obj = {
        sender: userId,
        msg: inputMsgBox.value || null,
        img: null,
        sentAt: currentTime,
        fileName: imgInputBox.files.length > 0 ? imgInputBox.files[0].name : null
      };


      // ì´ë¯¸ì§€ íŒŒì¼ì´ ì„ íƒë˜ì—ˆìœ¼ë©´ base64ë¡œ ì¸ì½”ë”©í•˜ì—¬ ì¶”ê°€
      if (imgInputBox.files.length > 0) {
        var reader = new FileReader();
        reader.onload = function(event) {
          obj.img = event.target.result;

          // ë©”ì‹œì§€ë‚˜ ì´ë¯¸ì§€ ì¤‘ í•˜ë‚˜ê°€ ìˆìœ¼ë©´ ì „ì†¡
          if (obj.msg || obj.img) {
            g_webSocket.send(JSON.stringify(obj));
          }
        };
        reader.readAsDataURL(imgInputBox.files[0]);
      } else {
        // ì´ë¯¸ì§€ê°€ ì—†ì„ ê²½ìš° ë©”ì‹œì§€ê°€ ìˆëŠ”ì§€ í™•ì¸ í›„ ì „ì†¡
        if (obj.msg) {
          g_webSocket.send(JSON.stringify(obj));
        }
      }

      inputMsgBox.value = "";
      imgInputBox.value = "";
      inputMsgBox.focus();

      return true;
    }

    function inputMsgBox_onkeypress(event) {
      if (event == null) {
        return false;
      }
      var keyCode = event.keyCode || event.which;
      if (keyCode == 13) {
        sendButton_onclick(event);
      }
    }

    function getCurrentFormattedTime() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');

      return `${year}.${month}.${day} ${hours}:${minutes}`;
    }

  </script>
  <style>

    .participant-item {
      margin: 5px 3px; /* Space between participants */
      padding: 10px; /* Padding for better click area */
      background-color: #f0f0f0; /* Background color */
      border-radius: 3px; /* Rounded corners */
      cursor: pointer; /* Pointer cursor on hover */
    }

    .participant-item:hover {
      background-color: #e0e0e0; /* Change color on hover */
    }
    .host-header {
      padding: 14px 15px; /* íŒ¨ë”© */
      background-color:#808080 ; /* ë°°ê²½ìƒ‰ */
      font-size: 16px; /* Adjust as needed */
      font-weight: bold; /* Bold text */
      margin-bottom: 10px; /* Spacing below the header */
      color: white; /* Text color */
    }
    .expand-button {
      background-color: transparent; /* ë°°ê²½ìƒ‰ íˆ¬ëª… */
      border: none; /* í…Œë‘ë¦¬ ì œê±° */
      color: white; /* ê¸€ì ìƒ‰ìƒ */
      cursor: pointer; /* í¬ì¸í„° ì»¤ì„œ */
      font-size: 16px; /* ê¸€ì í¬ê¸° */
      transition: color 0.3s; /* ìƒ‰ìƒ ì „í™˜ íš¨ê³¼ */
    }




    .chat-button {
      position: fixed;
      right: 50px; /* ì˜¤ë¥¸ìª½ì—ì„œì˜ ê°„ê²© */
      top: 50%; /* í™”ë©´ ì¤‘ê°„ ìœ„ì¹˜ */
      transform: translateY(-50%); /* ë²„íŠ¼ì„ ì¤‘ì•™ì— ìœ„ì¹˜ì‹œí‚´ */
      z-index: 1000; /* ë‹¤ë¥¸ ìš”ì†Œ ìœ„ì— í‘œì‹œë˜ë„ë¡ */
      cursor: pointer; /* í¬ì¸í„° ì»¤ì„œ */
      font-size: 40px; /* ì•„ì´ì½˜ í¬ê¸° */
      color: #007BFF; /* ì•„ì´ì½˜ ìƒ‰ìƒ */
      transition: transform 0.3s; /* í¬ê¸° ë³€í™˜ íš¨ê³¼ */
    }

    /* ì•Œë¦¼ ë°°ì§€ ìŠ¤íƒ€ì¼ */
    .notification-badge {
      position: absolute;
      top: -5px; /* ë²„íŠ¼ ìœ„ìª½ ìœ„ì¹˜ ì¡°ì • */
      right: -10px; /* ë²„íŠ¼ ì˜¤ë¥¸ìª½ ìœ„ì¹˜ ì¡°ì • */
      background-color: red; /* ë°°ê²½ìƒ‰ */
      color: white; /* ê¸€ì ìƒ‰ìƒ */
      border-radius: 50%; /* ë‘¥ê¸€ê²Œ */
      padding: 5px 10px; /* íŒ¨ë”© */
      font-size: 12px; /* ê¸€ì í¬ê¸° */
      font-weight: bold; /* ê¸€ì ë‘ê»ê²Œ */
      display: inline-block; /* ì¸ë¼ì¸ ë¸”ë¡ */
    }



    /* ì±„íŒ… í—¤ë” ìŠ¤íƒ€ì¼ */
    .chat-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color:#808080 ; /* ë°°ê²½ìƒ‰ */
      color: white; /* ê¸€ì ìƒ‰ìƒ */
      padding: 10px 15px; /* íŒ¨ë”© */
      border-top-left-radius: 5px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
      border-top-right-radius: 5px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); /* ê·¸ë¦¼ì ì¶”ê°€ */
    }

    .challenge-title, .trainer-title {
      font-size: 16px; /* ê¸€ì í¬ê¸° */
      font-weight: bold; /* ê¸€ì ë‘ê»ê²Œ */
    }

    .close-button {
      background-color: transparent; /* ë°°ê²½ìƒ‰ íˆ¬ëª… */
      border: none; /* í…Œë‘ë¦¬ ì œê±° */
      color: white; /* ê¸€ì ìƒ‰ìƒ */
      cursor: pointer; /* í¬ì¸í„° ì»¤ì„œ */
      font-size: 16px; /* ê¸€ì í¬ê¸° */
      transition: color 0.3s; /* ìƒ‰ìƒ ì „í™˜ íš¨ê³¼ */
    }
    .back-button {
      background-color: transparent; /* ë°°ê²½ìƒ‰ íˆ¬ëª… */
      border: none; /* í…Œë‘ë¦¬ ì œê±° */
      color: white; /* ê¸€ì ìƒ‰ìƒ */
      cursor: pointer; /* í¬ì¸í„° ì»¤ì„œ */
      font-size: 16px; /* ê¸€ì í¬ê¸° */
      transition: color 0.3s; /* ìƒ‰ìƒ ì „í™˜ íš¨ê³¼ */
    }


    .close-button:hover {
      color: #FF6B6B; /* hover ì‹œ ìƒ‰ìƒ ë³€ê²½ */
    }



    .participants-list {
      width: 250px; /* ì°¸ì—¬ì ëª©ë¡ ë„ˆë¹„ */
      background-color: white; /* ë°°ê²½ìƒ‰ */
      border: 1px solid #ccc;
      border-radius: 5px;
      overflow-y: auto; /* ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
      height: 490px; /* ë†’ì´ ì„¤ì • */
      position: absolute; /* ì ˆëŒ€ ìœ„ì¹˜ ì„¤ì • */
      left: -270px; /* ì±— ìœˆë„ìš°ì˜ ì™¼ìª½ ë°”ê¹¥ìª½ì— ìœ„ì¹˜í•˜ë„ë¡ ì„¤ì • */
      top: 0; /* ìœ„ìª½ ì •ë ¬ */
    }

    /* ì±„íŒ…ì°½ ìŠ¤íƒ€ì¼ */
    .chat-window {
      position: fixed;
      right: 20px;
      bottom: 20px;
      width: 500px; /* ì±„íŒ…ì°½ ë„ˆë¹„ */
      height: 600px; /* ì±„íŒ…ì°½ ê³ ì • ë†’ì´ */
      border: 1px solid #ccc;
      border-radius: 5px;
      display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
      background-color: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 1001; /* ë²„íŠ¼ë³´ë‹¤ ìœ„ì— í‘œì‹œë˜ë„ë¡ */
    }
    .chat-window.expanded {
      width: 1400px; /* Expanded width */
      height: 900px; /* Expanded height */
    }

    /* ì±„íŒ… ë³¸ë¬¸ ìŠ¤íƒ€ì¼ */
    .chat-body {
      padding: 10px;
      height: calc(100% - 80px); /* í—¤ë”ì™€ í‘¸í„°ë¥¼ ì œì™¸í•œ ë†’ì´ ê³„ì‚° */
    }

    /* ëª©ë¡ ìŠ¤íƒ€ì¼ */
    .myChall-list {
      margin: 5px 0;
      padding: 20px;
      border-radius: 3px;
      background-color: #f0f0f0; /* ë°°ê²½ìƒ‰ */
      cursor: pointer;
    }

    .myChall-list:hover {
      background-color: #e0e0e0; /* hover ì‹œ ìƒ‰ìƒ ë³€ê²½ */
    }






    #chatBoxArea {
      width: 100%;
      height: calc(100% - 80px); /* ì±„íŒ… ë°•ìŠ¤ì˜ ë†’ì´ë¥¼ ì „ì²´ ë†’ì´ì—ì„œ ì¸í’‹ ì»¨í…Œì´ë„ˆì˜ ë†’ì´ë¥¼ ë¹¼ì„œ ì¡°ì • */
      border: none;
      padding: 20px;
      box-sizing: border-box;
      overflow-y: auto;
      background-color: #e8e8e8; /* ë°°ê²½ìƒ‰ í†µì¼ */
      font-size: 16px; /* ê¸€ì”¨ í¬ê¸° ì¦ê°€ */
      display: flex;
      flex-direction: column; /* ì„¸ë¡œ ì •ë ¬ */
      align-items: stretch;
    }

    #inputContainer {
      display: flex;
      align-items: center;
      padding: 15px;
      height: 80px; /* ì¸í’‹ ì»¨í…Œì´ë„ˆ ë†’ì´ ì¡°ì • */
      gap: 10px;
      justify-content: center; /* ë²„íŠ¼ì„ ê°€ìš´ë° ì •ë ¬ */
    }

    #inputMsgBox {
      flex: 1;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px; /* ê¸€ì”¨ í¬ê¸° ì¦ê°€ */
      height: 50px; /* ë†’ì´ ì¦ê°€ */
    }

    #sendButton, #disconnectButton, #fileButton {
      background-color: #808080; /* ê²€ì •ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px; /* ê¸€ì”¨ í¬ê¸° ì¦ê°€ */
      margin-left: 10px; /* ë²„íŠ¼ ì‚¬ì´ ê°„ê²© ì¶”ê°€ */
    }

    #disconnectButton {
      background-color: #000; /* ê²€ì •ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
    }



    #sendButton:hover, #disconnectButton:hover, #fileButton:hover {
      opacity: 0.8;
    }

    #imgInputBox {
      display: none; /* ìˆ¨ê²¨ì§„ íŒŒì¼ ì…ë ¥ í•„ë“œ */
    }

    .message {
      padding: 10px;
      margin: 5px;
      border-radius: 10px;
      max-width: 80%;
      word-break: break-word;
      display: inline-block; /* ì»¨í…Œì´ë„ˆë¥¼ ì¸ë¼ì¸ ë¸”ë¡ìœ¼ë¡œ ì„¤ì • */
    }


    .message.sent {
      align-self: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
      background-color: #e1ffc7; /* ë‹¤ë¥¸ ë°°ê²½ìƒ‰ìœ¼ë¡œ í‘œì‹œ */
      text-align: right; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
      position: relative; /* ë°œì‹ ì ì•„ì´ë””ë¥¼ ìœ„ì¹˜ì‹œí‚¤ê¸° ìœ„í•´ ìƒëŒ€ ìœ„ì¹˜ ì„¤ì • */
    }

    .message.received {
      align-self: flex-start; /* ì™¼ìª½ ì •ë ¬ */
      background-color: #f1f0f0; /* ê¸°ë³¸ ë°°ê²½ìƒ‰ */
      text-align: left; /* ì™¼ìª½ ì •ë ¬ */
      position: relative; /* ë°œì‹ ì ì•„ì´ë””ë¥¼ ìœ„ì¹˜ì‹œí‚¤ê¸° ìœ„í•´ ìƒëŒ€ ìœ„ì¹˜ ì„¤ì • */
    }

    .image-container {
      margin-top: 10px;
      max-width: 80%;
      word-break: break-word;
      display: flex;
      flex-direction: column;
      align-items: flex-start; /* ê¸°ë³¸ ì™¼ìª½ ì •ë ¬ */
    }



    .sender-id {
      font-size: 12px;
      color: #666;
      margin-bottom: 5px;
    }
    .image-container.received {
      align-items: flex-start; /* ê¸°ë³¸ ì™¼ìª½ ì •ë ¬ */
      text-align: left; /* ì™¼ìª½ ì •ë ¬ */
    }

    /* ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ ìˆ˜ì • */
    .image-container img {
      max-width: 80%; /* ì»¨í…Œì´ë„ˆì˜ ë„ˆë¹„ì— ë§ì¶°ì„œ í¬ê¸° ì¡°ì ˆ */
      max-height: 80%; /* ìµœëŒ€ ë†’ì´ ì„¤ì • */
      height: auto; /* ë¹„ìœ¨ ìœ ì§€ */
      border-radius: 8px;
    }

    /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .image-container button {
      margin: 2px 5px; /* ìƒí•˜ ì—¬ë°±ì„ ì¤„ì´ê³ , ì¢Œìš° ì—¬ë°± ìœ ì§€ */
    }

    .image-container.sent {
      align-self: flex-end;
      align-items: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
      text-align: right; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
      margin-right: 0; /* ì˜¤ë¥¸ìª½ ì—¬ë°± ì œê±° */
      padding-right: 0; /* ì˜¤ë¥¸ìª½ íŒ¨ë”© ì œê±° */


    }


    .current-challenge-title {
      font-size: 24px; /* ê¸€ì í¬ê¸° */
      font-weight: bold; /* ê¸€ì ë‘ê»˜ */
      color: white; /* ê¸€ì ìƒ‰ìƒ */
      padding: 5px 5px; /* ì•ˆìª½ ì—¬ë°± */
      text-align: center; /* ê°€ìš´ë° ì •ë ¬ */
    }

    .participants-title,.trainer-title,.challenge-title {
      cursor: pointer; /* ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ì†ê°€ë½ ëª¨ì–‘ìœ¼ë¡œ ë³€ê²½ */
    }

  </style>
</div>
</body>
</html>